<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, viewport-fit=cover"
        />

        <title>Undangan Mepradang dan Mepejati</title>

        <!-- Bootstrap 5 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
            crossorigin="anonymous"
        />

        <!-- Bootstrap 5 Icons -->
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
        />

        <!-- CSS Externals -->
        <link rel="stylesheet" href="style.css" />

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Playwrite+CA:wght@100..400&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Patua+One&display=swap"
            rel="stylesheet"
        />

        <!-- Simply Countdown -->
        <link rel="stylesheet" href="dist-countdown/themes/default.css" />

        <!-- Animate on Scroll -->
        <link
            rel="stylesheet"
            href="https://unpkg.com/aos@2.3.1/dist/aos.css"
        />

        <!-- FontAwesome -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />

        <!-- Favicon -->
        <link
            rel="icon"
            href="favicon.png?v=2"
            sizes="32x32"
            type="image/png"
        />
    </head>

    <body>
        <!-- Section landing-page -->
        <section id="landing-page" class="landing-page">
            <div class="safe-area">
                <div class="guest-box guest-row">
                    <h3 class="myFont">
                        Undangan <br class="br-mobile" />
                        Mepradang &amp; Mepejati
                    </h3>
                    <img
                        src="src/img/assets/amkara.png"
                        alt="Om Symbol"
                        class="guest-ornament"
                    />
                    <p>Kepada Yth.</p>
                    <p>Bapak/Ibu/Saudara/I</p>
                    <h3 class="guest-name">Tamu Undangan</h3>
                    <a href="#wedding-title" class="btn-enter"
                        ><i class="fa-solid fa-envelope"></i>Buka Undangan</a
                    >
                </div>
            </div>
        </section>

        <!-- Section Wedding Title -->
        <section id="wedding-title" class="wedding-title">
            <div class="ornament-top">
                <img
                    data-aos="fade-down"
                    data-aos-duration="2000"
                    data-aos-offset="0"
                    src="src/img/assets/ornamentTop.png"
                    alt="Ornament Top"
                />
            </div>

            <div class="wedding-text">
                <div class="wedding-container">
                    <p class="subtitle">The Wedding Of</p>
                    <h1 class="bride-groom">Dhani & Ditha</h1>
                </div>
            </div>

            <div class="ornament-bottom">
                <img
                    data-aos="fade-up"
                    data-aos-duration="2000"
                    data-aos-offset="0"
                    src="src/img/assets/ornamentBottom.png"
                    alt="Ornament Bottom"
                />
            </div>
        </section>

        <!-- Section Doa -->
        <section id="doa" class="doa">
            <!-- Ornament Background -->
            <div class="doa-ornaments">
                <img
                    src="src/img/assets/frame.png"
                    class="ornament bottom-left"
                    alt="ornament"
                />
                <img
                    src="src/img/assets/frame.png"
                    class="ornament bottom-right"
                    alt="ornament"
                />
            </div>

            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-md-8 col-10 py-5">
                        <img
                            class="img-omswastyastu"
                            src="src/img/assets/om-swastyastu.png"
                            alt="Om Swastyastu"
                            style="margin-bottom: 12px"
                        />
                        <h2 class="title-omSwastyastu">Om Swastyastu</h2>

                        <p class="veda-verse" style="text-align: justify">
                            <i>
                                Iha-imƒÅv-indra sam nuda CakravƒÅkeva dampati.
                            </i>
                        </p>

                        <h5 class="veda-title">
                            <i class="fa-solid fa-book"></i> Atharvaveda :
                            XIV.2.64
                        </h5>

                        <p class="veda-meaning" style="text-align: justify">
                            Ya Tuhan, karuniailah kepada pasangan ini untuk
                            memiliki cinta kasih yang tulus dalam membina
                            kehidupan berumah tangga.
                        </p>

                        <p class="title-doa" style="text-align: justify">
                            Atas Asung Kertha Wara Nugraha Ida Sang Hyang Widhi
                            Wasa/Tuhan Yang Maha Esa, perkenankan kami
                            mengundang Bapak/Ibu/Saudara/I pada Resepsi
                            Pawiwahan (Pernikahan) & Mepandes (Potong Gigi)
                            putra-putri kami.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Groom and Bride  -->
        <section id="couple" class="couple-section">
            <div class="overlay-gradient"></div>

            <div class="couple-content">
                <!-- Groom -->
                <div
                    class="person groom"
                    data-aos="fade-right"
                    data-aos-duration="2000"
                >
                    <h3 class="nickname">Dhani</h3>
                    <h4 class="fullname">Yandhani Astika Putra, S.T.</h4>
                    <p class="parents">
                        Putra pertama dari <br />
                        Drs. I Wayan Suriada <br />
                        &amp; <br />
                        Ni Nengah Ayu Hastina Wathy, S.Pd.
                    </p>

                    <a
                        class="btn-ig"
                        href="https://www.instagram.com/yandhaniastika/"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        <svg
                            class="ig-icon"
                            viewBox="0 0 24 24"
                            aria-hidden="true"
                        >
                            <rect
                                x="3"
                                y="3"
                                width="18"
                                height="18"
                                rx="5"
                                ry="5"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="12"
                                cy="12"
                                r="3.8"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="17.3"
                                cy="6.7"
                                r="1.2"
                                fill="currentColor"
                            />
                        </svg>
                        Instagram Dhani
                    </a>
                </div>

                <!-- Bride -->
                <div
                    class="person bride"
                    data-aos="fade-left"
                    data-aos-duration="2000"
                >
                    <h3 class="nickname">Ditha</h3>
                    <h4 class="fullname">Putu Ditha Putri Cahyani, S.K.M.</h4>
                    <p class="parents">
                        Putri pertama dari <br />
                        AKBP (Purn.) I Ketut Perten <br />
                        & <br />
                        Ni Made Warniki, S.E.
                    </p>

                    <!-- ‚¨áÔ∏è Tombol Instagram Bride -->
                    <a
                        class="btn-ig"
                        href="https://www.instagram.com/dithacahyani/"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        <svg
                            class="ig-icon"
                            viewBox="0 0 24 24"
                            aria-hidden="true"
                        >
                            <rect
                                x="3"
                                y="3"
                                width="18"
                                height="18"
                                rx="5"
                                ry="5"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="12"
                                cy="12"
                                r="3.8"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="17.3"
                                cy="6.7"
                                r="1.2"
                                fill="currentColor"
                            />
                        </svg>
                        Instagram Ditha
                    </a>
                </div>
            </div>
        </section>

        <!-- Section Couple - Mobile Only -->
        <section
            id="couple-mobile"
            class="couple-mobile"
            aria-label="Couple (Mobile)"
        >
            <!-- Groom -->
            <div class="mobile-person groom" role="group" aria-label="Groom">
                <span class="mobile-overlay" aria-hidden="true"></span>
                <div
                    class="mobile-text"
                    data-aos="fade-up"
                    data-aos-duration="2000"
                >
                    <h3 class="nickname">Dhani</h3>
                    <h4 class="fullname">Yandhani Astika Putra, S.T.</h4>
                    <p class="parents">
                        Putra pertama dari <br />
                        Drs. I Wayan Suriada <br />
                        &amp; <br />
                        Ni Nengah Ayu Hastina Wathy, S.Pd.
                    </p>

                    <!-- ‚¨áÔ∏è Tombol Instagram Bride -->
                    <a
                        class="btn-ig"
                        href="https://www.instagram.com/yandhaniastika/"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        <svg
                            class="ig-icon"
                            viewBox="0 0 24 24"
                            aria-hidden="true"
                        >
                            <rect
                                x="3"
                                y="3"
                                width="18"
                                height="18"
                                rx="5"
                                ry="5"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="12"
                                cy="12"
                                r="3.8"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="17.3"
                                cy="6.7"
                                r="1.2"
                                fill="currentColor"
                            />
                        </svg>
                        Instagram Dhani
                    </a>
                </div>
            </div>

            <!-- Bride -->
            <div class="mobile-person bride" role="group" aria-label="Bride">
                <span class="mobile-overlay" aria-hidden="true"></span>
                <div
                    class="mobile-text"
                    data-aos="fade-up"
                    data-aos-duration="2000"
                >
                    <h3 class="nickname">Ditha</h3>
                    <h4 class="fullname">Putu Ditha Putri Cahyani, S.K.M.</h4>
                    <p class="parents">
                        Putri pertama dari <br />
                        AKBP (Purn.) I Ketut Perten <br />
                        &amp; <br />
                        Ni Made Warniki, S.E.
                    </p>

                    <!-- ‚¨áÔ∏è Tombol Instagram Groom -->
                    <a
                        class="btn-ig"
                        href="https://www.instagram.com/dithacahyani/"
                        target="_blank"
                        rel="noopener noreferrer"
                    >
                        <svg
                            class="ig-icon"
                            viewBox="0 0 24 24"
                            aria-hidden="true"
                        >
                            <rect
                                x="3"
                                y="3"
                                width="18"
                                height="18"
                                rx="5"
                                ry="5"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="12"
                                cy="12"
                                r="3.8"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="1.8"
                            />
                            <circle
                                cx="17.3"
                                cy="6.7"
                                r="1.2"
                                fill="currentColor"
                            />
                        </svg>
                        Instagram Ditha
                    </a>
                </div>
            </div>
        </section>

        <!-- Section: Wedding Date -->
        <section
            id="wedding-date"
            class="wedding-date-section"
            aria-label="Wedding Date"
        >
            <span class="wd-overlay" aria-hidden="true"></span>

            <div class="wd-container">
                <h2 class="wd-title">Save Our Date</h2>

                <!-- Event details (vertical) -->
                <div class="event-list">
                    <div
                        class="event-card"
                        data-aos="zoom-in"
                        data-aos-duration="1500"
                    >
                        <h3 class="event-title">Mepradang dan Mepejati</h3>
                        <p class="event-date">Minggu, 2 November 2025</p>
                        <p class="event-time">11.00 - 14.00 WITA</p>
                        <p class="event-location">
                            Banjar Petak, Desa Petak Kaja, Kab. Gianyar, Bali
                        </p>
                    </div>
                    <!-- Countdown (vanilla, no library) -->
                    <!-- HTML -->
                    <div
                        id="countdown-02"
                        class="wd-countdown"
                        role="timer"
                        aria-live="polite"
                        data-aos="zoom-in"
                        data-aos-duration="1500"
                    >
                        <div class="cd-item">
                            <span class="cd-value" data-part="days">00</span
                            ><span class="cd-label">Days</span>
                        </div>
                        <div class="cd-item">
                            <span class="cd-value" data-part="hours">00</span
                            ><span class="cd-label">Hours</span>
                        </div>
                        <div class="cd-item">
                            <span class="cd-value" data-part="mins">00</span
                            ><span class="cd-label">Minutes</span>
                        </div>
                        <div class="cd-item">
                            <span class="cd-value" data-part="secs">00</span
                            ><span class="cd-label">Seconds</span>
                        </div>
                    </div>
                </div>

                <!-- Google Maps button (dummy link) -->
                <a
                    class="btn-map"
                    href="https://maps.app.goo.gl/VjN3vj28rMamHrQy6"
                    target="_blank"
                    rel="noopener"
                >
                    <i class="fa-solid fa-map-location-dot"></i> Open in Google
                    Maps
                </a>
            </div>
        </section>

        <section id="gallery" class="gallery-section">
            <div class="overlay"></div>
            <div class="container py-5 position-relative">
                <h2 class="text-center mb-5 gallery-title">
                    Pre-Wedding Gallery
                </h2>
                <div class="gallery-grid">
                    <!-- 22 foto -->
                    <img
                        src="src/img/gallery/g1.webp"
                        alt="Gallery 1"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g2.webp"
                        alt="Gallery 2"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g3.webp"
                        alt="Gallery 3"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g4.webp"
                        alt="Gallery 4"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g5.webp"
                        alt="Gallery 5"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g6.webp"
                        alt="Gallery 6"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g7.webp"
                        alt="Gallery 7"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g8.webp"
                        alt="Gallery 8"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g9.webp"
                        alt="Gallery 9"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g10.webp"
                        alt="Gallery 10"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g11.webp"
                        alt="Gallery 11"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g12.webp"
                        alt="Gallery 12"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g13.webp"
                        alt="Gallery 13"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g14.webp"
                        alt="Gallery 14"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g15.webp"
                        alt="Gallery 15"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g16.webp"
                        alt="Gallery 16"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g17.webp"
                        alt="Gallery 17"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g18.webp"
                        alt="Gallery 18"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g19.webp"
                        alt="Gallery 19"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g20.webp"
                        alt="Gallery 20"
                        class="landscape"
                    />
                    <img
                        src="src/img/gallery/g21.webp"
                        alt="Gallery 21"
                        class="portrait"
                    />
                    <img
                        src="src/img/gallery/g22.webp"
                        alt="Gallery 22"
                        class="portrait"
                    />
                </div>
            </div>
        </section>

        <!-- Lightbox -->
        <!-- Lightbox -->
        <div
            id="lightbox"
            class="lb"
            role="dialog"
            aria-modal="true"
            aria-hidden="true"
        >
            <figure class="lb-stage" aria-live="polite">
                <img id="lb-image" alt="" decoding="async" />
                <figcaption class="lb-footnote">
                    Swipe to the Next Image
                </figcaption>
            </figure>

            <!-- Tombol fixed -->
            <button
                type="button"
                class="lb-btn lb-close"
                aria-label="Close (Esc)"
            >
                √ó
            </button>
            <button
                type="button"
                class="lb-btn lb-prev"
                aria-label="Previous (‚Üê)"
            >
                ‚Äπ
            </button>
            <button type="button" class="lb-btn lb-next" aria-label="Next (‚Üí)">
                ‚Ä∫
            </button>
        </div>

        <section id="rsvp" class="rsvp-section" aria-label="RSVP & Wishes">
            <div class="rsvp-container">
                <header class="rsvp-header">
                    <h2 class="rsvp-title">Konfirmasi Kehadiran dan Ucapan</h2>
                </header>

                <form
                    id="rsvp-form"
                    class="rsvp-form"
                    action="#"
                    method="post"
                    novalidate
                >
                    <div class="form-grid">
                        <!-- 1) Name -->
                        <div class="form-field">
                            <label for="guestName">Nama</label>
                            <input
                                type="text"
                                id="guestName"
                                name="Name"
                                placeholder="Nama Lengkap"
                            />
                        </div>

                        <!-- 2) Confirmation -->
                        <div class="form-field">
                            <label for="confirmation">Konfirmasi</label>
                            <select id="confirmation" name="Confirmation">
                                <option value="" selected disabled>
                                    Pilih Kehadiran...
                                </option>
                                <option value="attending">Hadir</option>
                                <option value="not_attending">
                                    Tidak Hadir
                                </option>
                            </select>
                        </div>

                        <!-- 3) Number of Guests -->
                        <div class="form-field">
                            <label for="guests">Jumlah Tamu</label>
                            <input
                                type="number"
                                id="guests"
                                name="Guests"
                                inputmode="numeric"
                                step="1"
                                placeholder="cth: 2"
                                min="1"
                                max="5"
                            />
                        </div>

                        <!-- 4) Wishes -->
                        <div class="form-field form-field--full">
                            <label for="wishes">Ucapan</label>
                            <textarea
                                id="wishes"
                                name="Wishes"
                                rows="4"
                                placeholder="Tulis ucapan dan doa terbaikmu di sini..."
                            ></textarea>
                        </div>
                    </div>

                    <!-- 5) Button -->
                    <div class="form-actions">
                        <!-- type="button" supaya belum submit; nanti kamu pasang logic sendiri -->
                        <button type="button" id="btn-rsvp" class="btn-submit">
                            Kirim <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </div>
                </form>

                <section
                    id="wishes-wall"
                    class="wishes-section"
                    aria-label="Wishes"
                >
                    <h3 class="wishes-title">Kartu Ucapan</h3>

                    <div id="wishes-list" class="wishes-list">
                        <!-- items dirender via JS -->
                    </div>

                    <nav
                        class="wishes-pagination"
                        aria-label="Wishes pagination"
                    >
                        <button
                            type="button"
                            id="wPrev"
                            class="w-btn"
                            aria-label="Previous page"
                        >
                            &larr; Sebelumnya
                        </button>
                        <span id="wPage" class="w-page">1/1</span>
                        <button
                            type="button"
                            id="wNext"
                            class="w-btn"
                            aria-label="Next page"
                        >
                            Berikutnya &rarr;
                        </button>
                    </nav>
                </section>
            </div>
        </section>

        <!-- Section Penutup -->
        <section id="closing" class="closing" aria-label="Penutup">
            <div class="safe-area">
                <div class="closing__inner">
                    <p class="closing__quote text-center">
                        SETIAP UCAPAN DAN DOA YANG DIBERIKAN, JADI BAGIAN INDAH
                        DALAM CERITA KAMI. TAK SABAR MENYAMBUT
                        BAPAK/IBU/SAUDARA/I DI HARI SPESIAL KAMI NANTI.
                    </p>

                    <h3 class="closing__names">
                        Dhani
                        <span class="closing__icon" aria-hidden="true"></span>
                        Ditha
                        <!-- kamu bisa ganti background-image di CSS untuk icon ini -->
                    </h3>
                    <h2 class="title-omShanti text-center">
                        Om Shanti Shanti Shanti Om
                    </h2>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <!-- Footer -->
        <footer
            id="site-footer"
            class="site-footer"
            role="contentinfo"
            aria-label="Footer"
        >
            <div class="">
                <div class="footer__inner">
                    <p class="footer__copy">
                        <span class="year">2025</span>
                        <i
                            class="fa-regular fa-copyright"
                            aria-hidden="true"
                        ></i>
                        Made with ü´∂üèª ‚Äî <strong>Dekwid Aryama Putra</strong>
                    </p>

                    <nav class="footer__socials" aria-label="Social media">
                        <!-- Ganti href="#" ke link kamu -->
                        <a
                            href="https://www.instagram.com/dekwidap/"
                            class="social-link"
                            aria-label="Instagram"
                            target="_blank"
                            rel="noopener"
                        >
                            <i
                                class="fa-brands fa-instagram"
                                aria-hidden="true"
                            ></i>
                        </a>
                        <a
                            href="https://www.facebook.com/dekwidaryama/"
                            class="social-link"
                            aria-label="Facebook"
                            target="_blank"
                            rel="noopener"
                        >
                            <i
                                class="fa-brands fa-facebook-f"
                                aria-hidden="true"
                            ></i>
                        </a>
                        <a
                            href="https://github.com/dekwidap"
                            class="social-link"
                            aria-label="GitHub"
                            target="_blank"
                            rel="noopener"
                        >
                            <i
                                class="fa-brands fa-github"
                                aria-hidden="true"
                            ></i>
                        </a>
                    </nav>
                </div>
            </div>
        </footer>

        <!-- Musik -->
        <!-- Background music (mulai setelah Open Invitation) -->
        <audio id="bgm" preload="none" loop>
            <!-- utamakan m4a, tambah mp3 kalau ada -->
            <source src="src/audio/bgSound.m4a" type="audio/mp4" />
            <!-- <source src="src/audio/bgm.mp3" type="audio/mpeg"> -->
        </audio>

        <!-- Floating play/pause button -->
        <button
            id="music-toggle"
            class="music-btn"
            aria-label="Play music"
            aria-pressed="false"
        >
            <i class="fa-solid fa-play"></i>
        </button>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                // ====== SET TARGET WAKTU (WITA = UTC+08:00) ======
                const EVENT_DATE = new Date("2025-11-02T11:00:00+08:00"); // 2 Nov 2025, 11:00 WITA

                // Root countdown khusus LP-2
                const root = document.getElementById("countdown-02");
                if (!root) return; // diam saja kalau elemen tidak ada

                // Ambil elemen angka
                const el = {
                    d: root.querySelector('[data-part="days"]'),
                    h: root.querySelector('[data-part="hours"]'),
                    m: root.querySelector('[data-part="mins"]'),
                    s: root.querySelector('[data-part="secs"]'),
                };

                const pad = (n) => n.toString().padStart(2, "0");

                function renderZero() {
                    el.d && (el.d.textContent = "00");
                    el.h && (el.h.textContent = "00");
                    el.m && (el.m.textContent = "00");
                    el.s && (el.s.textContent = "00");
                }

                function tick() {
                    const diff = EVENT_DATE.getTime() - Date.now();

                    if (diff <= 0) {
                        renderZero();
                        clearInterval(timer);
                        return;
                    }

                    const sec = Math.floor(diff / 1000);
                    const days = Math.floor(sec / 86400);
                    const hrs = Math.floor((sec % 86400) / 3600);
                    const mins = Math.floor((sec % 3600) / 60);
                    const secs = sec % 60;

                    el.d && (el.d.textContent = pad(days));
                    el.h && (el.h.textContent = pad(hrs));
                    el.m && (el.m.textContent = pad(mins));
                    el.s && (el.s.textContent = pad(secs));
                }

                tick();
                const timer = setInterval(tick, 1000);

                // Inisialisasi AOS bila tersedia (supaya elemen data-aos tampil)
                if (window.AOS && typeof AOS.init === "function") {
                    AOS.init();
                }
            });
        </script>

        <!-- Bootstrap 5 -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"
        ></script>

        <!-- Simply Countdown JS -->
        <script src="dist-countdown/simplyCountdown.umd.js"></script>

        <!-- Light Box Image -->
        <script src="https://cdn.jsdelivr.net/npm/bs5-lightbox@1.8.5/dist/index.bundle.min.js"></script>

        <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                // ---- KONFIG ----
                const GAS_URL =
                    "https://script.google.com/macros/s/AKfycbz6BQ0EnCoBzUPc0OzmIC6KS82UTUOFHDzhlt43-FlE6ILrbeeybgxt9B1OSgqUK7kU/exec"; // ganti punyamu

                // helper query (tidak bentrok dengan jQuery)
                const qs = (sel, root = document) => root.querySelector(sel);

                // Toggle input guests sesuai konfirmasi
                (function setupGuestsToggle() {
                    const sel = qs("#confirmation");
                    const g = qs("#guests");
                    if (!sel || !g) return;
                    function apply() {
                        if (sel.value === "not_attending") {
                            g.value = "";
                            g.disabled = true;
                            g.placeholder = "‚Äî";
                        } else {
                            g.disabled = false;
                            g.placeholder = "cth: 2";
                        }
                    }
                    sel.addEventListener("change", apply);
                    apply();
                })();

                // === Toast minimal (kalau belum ada) ===
                const Toast =
                    window.Toast ||
                    (() => {
                        let root, timer;
                        function ensureRoot() {
                            if (!root) {
                                root = document.createElement("div");
                                root.id = "toast-root";
                                document.body.appendChild(root);
                            }
                        }
                        function hide() {
                            if (!root) return;
                            root.classList.remove("on");
                            clearTimeout(timer);
                            timer = null;
                            setTimeout(() => {
                                if (root) root.innerHTML = "";
                            }, 200);
                        }
                        function show(message, type = "info", opts = {}) {
                            ensureRoot();
                            clearTimeout(timer);
                            root.innerHTML = `<div class="toast ${type} ${
                                opts.loading ? "loading" : ""
                            }"><span class="t-icon"></span><div class="t-msg"></div></div>`;
                            root.querySelector(".t-msg").textContent = message;
                            requestAnimationFrame(() =>
                                root.classList.add("on")
                            );
                            if (!opts.persist) {
                                timer = setTimeout(hide, opts.autohide || 2500);
                            }
                            return {
                                update(msg, t = type, o = {}) {
                                    const box = root.querySelector(".toast");
                                    if (!box) return;
                                    box.className = `toast ${t} ${
                                        o.loading ? "loading" : ""
                                    }`;
                                    root.querySelector(".t-msg").textContent =
                                        msg;
                                    clearTimeout(timer);
                                    if (!o.persist) {
                                        timer = setTimeout(
                                            hide,
                                            o.autohide || 2500
                                        );
                                    }
                                },
                                close: hide,
                            };
                        }
                        return { show, hide };
                    })();

                // Escape HTML
                function escapeHTML(str) {
                    return (str || "")
                        .toString()
                        .replace(
                            /[&<>"']/g,
                            (s) =>
                                ({
                                    "&": "&amp;",
                                    "<": "&lt;",
                                    ">": "&gt;",
                                    '"': "&quot;",
                                    "'": "&#39;",
                                }[s])
                        );
                }

                // State wishes & pagination
                const MOBILE_PAGE_SIZE = 3;
                const DESKTOP_PAGE_SIZE = 6;
                const getPageSize = () =>
                    matchMedia("(max-width: 768px)").matches
                        ? MOBILE_PAGE_SIZE
                        : DESKTOP_PAGE_SIZE;
                let PAGE_SIZE = getPageSize();
                let wishesData = [];
                let currentPage = 1;

                function renderWishItem(item) {
                    return `<article class="wish-card">
      <div class="wish-name">${escapeHTML(item.name || "Guest")}</div>
      <div class="wish-msg">${escapeHTML(item.wishes || "")}</div>
    </article>`;
                }
                function renderWishesPage(page = 1) {
                    const listEl = qs("#wishes-list");
                    const pageEl = qs("#wPage");
                    const prevBtn = qs("#wPrev");
                    const nextBtn = qs("#wNext");
                    if (!listEl || !pageEl || !prevBtn || !nextBtn) return;

                    const total = Math.max(
                        1,
                        Math.ceil(wishesData.length / PAGE_SIZE)
                    );
                    currentPage = Math.min(Math.max(1, page), total);
                    const start = (currentPage - 1) * PAGE_SIZE;
                    const end = start + PAGE_SIZE;
                    const slice = wishesData.slice(start, end);

                    listEl.innerHTML = slice.map(renderWishItem).join("");
                    pageEl.textContent = `${currentPage}/${total}`;
                    prevBtn.disabled = currentPage <= 1;
                    nextBtn.disabled = currentPage >= total;
                }
                function addWishToData({ name, wishes }) {
                    wishesData.unshift({ name, wishes });
                    renderWishesPage(1);
                }

                // Load wishes via JSONP (pastikan GAS doGet support callback)
                function loadWishesFromSheet() {
                    const cb =
                        "wishesCB_" + Math.random().toString(36).slice(2);
                    const s = document.createElement("script");
                    window[cb] = function (resp) {
                        try {
                            if (resp && resp.ok && Array.isArray(resp.data)) {
                                wishesData = resp.data
                                    .filter(
                                        (it) =>
                                            (it.name && it.name.trim()) ||
                                            (it.wishes && it.wishes.trim())
                                    )
                                    .map((it) => ({
                                        name: it.name || "Guest",
                                        wishes: it.wishes || "",
                                    }));
                            } else {
                                wishesData = [];
                            }
                            renderWishesPage(1);
                        } finally {
                            delete window[cb];
                            s.remove();
                        }
                    };
                    s.src = `${GAS_URL}?callback=${cb}&_=${Date.now()}`;
                    document.body.appendChild(s);
                }

                // Submit handler (lebih andal daripada click tombol)
                const form = qs("#rsvp-form");
                const btn = qs("#btn-rsvp");
                async function processRSVP(evt) {
                    evt && evt.preventDefault();

                    const name = qs("#guestName")?.value.trim() || "";
                    const conf = qs("#confirmation")?.value || "";
                    const wishes = qs("#wishes")?.value.trim() || "";
                    const guestsEl = qs("#guests");

                    if (!name) {
                        Toast.show("Please enter your name.", "error");
                        return;
                    }
                    if (!conf) {
                        Toast.show("Please choose your confirmation.", "error");
                        return;
                    }

                    let guests = 0;
                    if (conf === "attending") {
                        const v = parseInt(guestsEl?.value || "0", 10);
                        if (!Number.isFinite(v) || v < 1 || v > 5) {
                            Toast.show(
                                "Number of Guests must be 1‚Äì5.",
                                "error"
                            );
                            return;
                        }
                        guests = v;
                    }

                    const payload = {
                        name,
                        confirmation: conf,
                        guests,
                        wishes,
                        ts: new Date().toISOString(),
                    };

                    const toast = Toast.show(
                        "Mengirim Konfirmasi dan Kartu Ucapan‚Ä¶",
                        "info",
                        { persist: true, loading: true }
                    );
                    const old = btn?.textContent;
                    btn?.classList.add("is-loading");
                    if (btn) btn.textContent = "Sending‚Ä¶";

                    try {
                        const body = new URLSearchParams(payload).toString();
                        const res = await fetch(GAS_URL, {
                            method: "POST",
                            headers: {
                                "Content-Type":
                                    "application/x-www-form-urlencoded",
                            },
                            body,
                        });
                        // opsional: cek status
                        if (!res.ok) {
                            throw new Error("GAS returned " + res.status);
                        }

                        if (wishes) addWishToData({ name, wishes });

                        toast.update("Berhasil! Terima kasih.", "success", {
                            autohide: 2200,
                        });
                        form?.reset();
                        qs("#confirmation")?.dispatchEvent(new Event("change"));
                    } catch (err) {
                        console.error(err);
                        toast.update(
                            "Send failed. Please try again.",
                            "error",
                            { autohide: 3000 }
                        );
                    } finally {
                        btn?.classList.remove("is-loading");
                        if (btn) btn.textContent = old || "Kirim";
                    }
                }

                // Pasang listener SECARA PASTI (DOM sudah siap)
                if (form) {
                    form.addEventListener("submit", processRSVP);
                }
                if (btn) {
                    btn.addEventListener("click", (e) => processRSVP(e));
                }

                // Pagination
                qs("#wPrev")?.addEventListener("click", () =>
                    renderWishesPage(currentPage - 1)
                );
                qs("#wNext")?.addEventListener("click", () =>
                    renderWishesPage(currentPage + 1)
                );

                // Inisialisasi page size & load wishes
                PAGE_SIZE = getPageSize();
                loadWishesFromSheet();

                // Responsif pagination (hindari saat user mengetik)
                const isFormFocused = () => {
                    const ae = document.activeElement;
                    return ae && /^(INPUT|TEXTAREA|SELECT)$/.test(ae.tagName);
                };
                let resizeTimer;
                window.addEventListener("resize", () => {
                    if (isFormFocused()) return;
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(() => {
                        const newSize = getPageSize();
                        if (newSize !== PAGE_SIZE) {
                            const firstIndex = (currentPage - 1) * PAGE_SIZE;
                            PAGE_SIZE = newSize;
                            const newPage =
                                Math.floor(firstIndex / PAGE_SIZE) + 1;
                            renderWishesPage(newPage);
                        }
                    }, 150);
                });
            });
        </script>
    </body>
</html>
